<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PowerFlow</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>PowerFlow</h1>
        <div class="status-indicator" id="status"></div>
      </header>

      <!-- Debug 資訊 -->
      <div id="debug" style="background: #333; color: #0f0; padding: 10px; font-family: monospace; font-size: 11px; margin: 10px 0;">
        Debug: Loading...
      </div>

      <main>
        <!-- 即時功率顯示 -->
        <section class="power-display">
          <div class="power-main">
            <div class="power-value">
              <span id="watts-actual" class="watts-number">--</span>
              <span class="watts-unit">W</span>
            </div>
            <div class="power-max">
              <span id="watts-max">--</span>W 最大
            </div>
          </div>

          <div class="power-bar">
            <div id="power-progress" class="power-progress"></div>
          </div>
        </section>

        <!-- 電池資訊 -->
        <section class="battery-info">
          <div class="info-row">
            <span class="label">電池</span>
            <span id="battery-percent" class="value">--</span>
          </div>
          <div class="info-row">
            <span class="label">電壓</span>
            <span id="voltage" class="value">--</span>
          </div>
          <div class="info-row">
            <span class="label">電流</span>
            <span id="amperage" class="value">--</span>
          </div>
          <div class="info-row">
            <span class="label">充電器</span>
            <span id="charger-name" class="value">--</span>
          </div>
        </section>

        <!-- 圖表區域 (未來實現) -->
        <section class="chart-section">
          <canvas id="power-chart"></canvas>
        </section>
      </main>

      <footer>
        <div class="last-update">
          最後更新: <span id="last-update">--</span>
        </div>
      </footer>
    </div>

    <script>
      // Debug 顯示在畫面上
      const debugEl = document.getElementById('debug');
      function debug(msg) {
        console.log(msg);
        if (debugEl) {
          debugEl.innerHTML += msg + '<br>';
        }
      }

      debug('=== Tauri Check ===');
      debug('Tauri exists: ' + (typeof window.__TAURI__ !== 'undefined'));

      if (window.__TAURI__) {
        debug('Tauri.core: ' + (typeof window.__TAURI__.core));
        debug('Tauri.event: ' + (typeof window.__TAURI__.event));
        debug('Invoke available: ' + (typeof window.__TAURI__.core?.invoke === 'function'));
        debug('Listen available: ' + (typeof window.__TAURI__.event?.listen === 'function'));
      } else {
        debug('ERROR: Tauri API not found!');
      }
    </script>
    <script type="module" src="main.js"></script>
  </body>
</html>
